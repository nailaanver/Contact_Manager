{% extends 'master.html' %}
{% load static%}

{% block title %}Dashboard - Contact Manager{% endblock %}

{% block content %}
<div class="dashboard-wrapper">

    <!-- Header -->
    <header class="dashboard-header">
        <div class="header-left">
            <div>
            <h2 class="welcome-text">Welcome, {{ user.username }}</h2>
            </div>
            <div class="user-profile">
                <img src="{% static 'images/profile-icon.png' %}" alt="Profile" class="profile-avatar" onclick="toggleDropdown()">
                <div id="profileDropdown" class="dropdown-menu">
                    <p><strong>{{ user.username }}</strong></p>
                    <p>{{ user.email }}</p>
                    <hr>
                    <a href="{% url 'edit_user' user.pk %}">Edit Profile</a>
                    <a href="{% url 'logout' %}">Log Out</a>
                </div>
            </div>
        </div>
    </header>

    <!-- Add Contact Button -->
   

    <!-- Contacts Section -->
    <section class="contacts-container">
        <h2 class="section-title">All Contacts</h2>
        <div class="table-wrapper">
            <table class="contacts-table">
                <thead>
                    <tr>
                        <th>Name</th>
                        <th>Email</th>
                        <th>Phone No</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody>
                    {% for contact in contacts %}
                    <tr>
                        <td>{{ contact.name }}</td>
                        <td>{{ contact.email }}</td>
                        <td>{{ contact.phone_number }}</td>
                        <td>
                            <a href="{% url 'edit_contact' contact.pk %}" class="btn-action btn-edit">
                                <i class="fa fa-pen"></i> Edit
                            </a>
                            <a href="{% url 'delete_contact' contact.id %}" class="btn-action btn-delete" onclick="return confirm('Are you sure you want to delete this contact?');">
                                <i class="fa fa-trash"></i> Delete
                            </a>
                        </td>
                    </tr>
                    {% empty %}
                    <tr>
                        <td colspan="4">No contacts found.</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
             
        </div>

        <a href="{% url 'add_contact' %}" class="btn-add-contact">
            <i class="fa fa-plus"></i> Add Contact
        </a>

    </section>

</div>

<!-- JS for Profile Dropdown -->
<script>
function toggleDropdown() {
    document.getElementById("profileDropdown").classList.toggle("show");
}

window.onclick = function(event) {
    if (!event.target.matches('.profile-avatar')) {
        var dropdowns = document.getElementsByClassName("dropdown-menu");
        for (var i = 0; i < dropdowns.length; i++) {
            dropdowns[i].classList.remove('show');
        }
    }
}
</script>
{% endblock %}
