{% extends 'master.html' %}
{% load static %}

{% block title %}Dashboard - Contact Manager{% endblock %}

{% block content %}
<div class="dashboard-container">
    <!-- ðŸ”¹ Header Section with Welcome + Profile -->
    <header class="dashboard-header">
        <h2 class="welcome">Welcome, {{ user.username }}</h2>

        <div class="profile-menu">
            <img src="{% static 'images/profile-icon.png' %}" alt="Profile" class="profile-icon" onclick="toggleDropdown()">
            
            <!-- Dropdown Menu -->
            <div id="profileDropdown" class="dropdown-content">
                <p><strong>{{ user.username }}</strong></p>
                <p>{{ user.email }}</p>
                <hr>
                <a href="{% url 'logout' %}">Logout</a>
            </div>
        </div>
    </header>

    <!-- ðŸ”¹ All Contacts Section -->
    <div class="contacts-section">
        <div class="contacts-header">
            <h2>All Contacts</h2>
            <div class="add-btn-sec">
                <a href="{% url 'add_contact' %}">
                    <button class="add-btn">Add Contact</button>
                </a>
            </div>
        </div>

        <!-- ðŸ”¹ Contact Table -->
        <div class="table-container">
            <table class="contact-table">
                <thead>
                    <tr>
                        <th>Name</th>
                        <th>Email</th>
                        <th>Phone No</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody>
                    {% for contact in contacts %}
                    <tr>
                        <td>{{ contact.name }}</td>
                        <td>{{ contact.email }}</td>
                        <td>{{ contact.phone_number }}</td>
                        <td>
                            <a href="{% url 'edit_contact' contact.pk %}" class="btn edit-btn">Edit</a>
                            <a href="{% url 'delete_contact' contact.id %}" class="btn delete-btn"
                               onclick="return confirm('Are you sure you want to delete this contact?');">Delete</a>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
</div>

<!-- ðŸ”¹ JavaScript for Dropdown -->
<script>
function toggleDropdown() {
    document.getElementById("profileDropdown").classList.toggle("show");
}

// Close dropdown if clicked outside
window.onclick = function(event) {
    if (!event.target.matches('.profile-icon')) {
        var dropdowns = document.getElementsByClassName("dropdown-content");
        for (var i = 0; i < dropdowns.length; i++) {
            dropdowns[i].classList.remove('show');
        }
    }
}
</script>

{% endblock %}
